Procédure pour la détection des insertions dans FLT3 :

1. Commande PINDEL
PINDEL détecte les variations complexes à partir des fichiers .bam. Avec le fichier de configuration contenant les informations de toutes les librairies (config_all_libs_flt3pindel) j'ai lancé le programme avec les options par défaut et le génome qui est le même que celui vraisemblablement utilisé par Sophia pour les alignements, dans la région contenant l'exon 14 de FLT3 :
/data/software/pindel/pindel -i config_all_libs_flt3pindel -f /data/genomes/Broadhs37/hs37d5.fa -o check_insertion_flt3_all_libs -c 13:28,608,000-28,608,800

2. Filtrage du fichier de sortie de PINDEL
A l'aide d'un script python process_pindel_output_SI.py j'ai parsé les résultats de PINDEL pour les "short insertions "(fichier _SI) pour les rendre lisibles et extraire les différents champs nécessaires à l'analyse des variants détectés. Le fichier de sortie en résultant est parsed_flt3_SIs_all_libs.csv. Les champs extraits sont : length, sequence (de l'insertion), chromosome, startrange (début flottant de la zone d'insertion), endrange (fin, idem), sum_scores (d'alignements) et pour chaque librairie : (coverage total,forward reads supporting l'insertion,forward reads uniques supporting l'insertion,idem tous reverse reads,idem unique reverse reads)

3. Filtrage avec R
Le fichier est ensuite lu et analysé avec le script R R_sort_flt3_insertions.R. Selon les échantillons ayant été testés auparavant en biologie moléculaire je définis la liste des positifs et négatifs ("gold standard") et je teste différents seuils pour le total des reads qui support une insertion afin de déterminer si l'échantillon présente une mutation ou non. On peut ainsi déterminer le seuil optimal qui était à 1200 dans ces tests. Un fichier de sortie est créé où ne figurent que les insertions supported par au moins 200 reads et où les échantillons avec un nombre total de reads >=1201 sont donnés comme mutés. La totalité des insertions possibles ne figurant pas dans le fichier, ce total peut être plus élevé que ce qui figure dans le fichier. Par ailleurs, seul l'échantillon 42 a moins de 1201 reads au total même s'il présente plusieurs insertions avec plus de 100 reads, et au moins une avec plus de 200 reads. Cet échantillon a été testé comme négatif en biomol, donc c'est un déterminant important dans le nombre de faux positifs, qui détermine le seuil pour une bonne partie. Finalement, les échantillons 28, 31 et 80 ne sont jamais trouvés comme positifs ici, avec presque aucun reads supportant une insertion, alors qu'ils étaient positifs en biomol. Le 80 et le 31 sont le même.
